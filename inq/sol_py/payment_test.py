

import json
from web3 import Web3
ganache_url="HTTP://127.0.0.1:7545"
web3=Web3(Web3.HTTPProvider(ganache_url))






web3.eth.defaultAccount=web3.eth.accounts[0]
contract_address='0x18ac542Dc3cEf86c0c63AdE7D0E226ab6D7D73Ed'


abi=json.loads("""[{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"from","type":"address"},{"indexed":false,"internalType":"address","name":"to","type":"address"},{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"nlanId","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"date","type":"uint256"}],"name":"PaymentSent","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"merchant","type":"address"},{"indexed":false,"internalType":"uint256","name":"planId","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"date","type":"uint256"}],"name":"PlanCreated","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"subscriber","type":"address"},{"indexed":false,"internalType":"uint256","name":"planId","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"date","type":"uint256"}],"name":"SubscriptionCancelled","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"merchent","type":"address"},{"indexed":false,"internalType":"uint256","name":"planId","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"date","type":"uint256"}],"name":"SubscriptionCreated","type":"event"},{"inputs":[{"internalType":"uint256","name":"planId","type":"uint256"}],"name":"cancel","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"token","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"},{"internalType":"uint256","name":"frequency","type":"uint256"}],"name":"createPlan","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"nextPlanId","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"subscriber","type":"address"},{"internalType":"uint256","name":"planId","type":"uint256"}],"name":"pay","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"plans","outputs":[{"internalType":"address","name":"merchant","type":"address"},{"internalType":"address","name":"token","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"},{"internalType":"uint256","name":"frequency","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"planId","type":"uint256"}],"name":"subscribe","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"},{"internalType":"uint256","name":"","type":"uint256"}],"name":"subscriptions","outputs":[{"internalType":"address","name":"subscriber","type":"address"},{"internalType":"uint256","name":"start","type":"uint256"},{"internalType":"uint256","name":"nextPayment","type":"uint256"}],"stateMutability":"view","type":"function"}]""")


bytecode="0x608060405234801561001057600080fd5b506004361061007d5760003560e01c8063623da3d11161005b578063623da3d1146100c6578063b16206161461012d578063c40768761461019c578063e95fc90f146101af57600080fd5b80630f574ba71461008257806340e58ee5146100975780635f8d26b2146100aa575b600080fd5b6100956100903660046108c3565b6101c2565b005b6100956100a53660046108c3565b6103e5565b6100b360005481565b6040519081526020015b60405180910390f35b6101086100d436600461083d565b600260208181526000938452604080852090915291835291208054600182015491909201546001600160a01b039092169183565b604080516001600160a01b0390941684526020840192909252908201526060016100bd565b61017161013b3660046108c3565b600160208190526000918252604090912080549181015460028201546003909201546001600160a01b0393841693909116919084565b604080516001600160a01b0395861681529490931660208501529183015260608201526080016100bd565b6100956101aa36600461083d565b6104cb565b6100956101bd366004610867565b6106a7565b60008181526001602081905260409091209081015481546001600160a01b039182169291166102385760405162461bcd60e51b815260206004820152601860248201527f7468697320706c616e20646f6573206e6f74206578697374000000000000000060448201526064015b60405180910390fd5b805460028201546040516323b872dd60e01b81523360048201526001600160a01b0392831660248201526044810191909152908316906323b872dd90606401602060405180830381600087803b15801561029157600080fd5b505af11580156102a5573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906102c9919061089a565b5080546002820154604080513381526001600160a01b039093166020840152820152606081018490524260808201527f577462848cc2ec95e5ef95bf0b154b97340221cd1002ea0511a3877a7f20fb8c9060a00160405180910390a16040518060600160405280336001600160a01b0316815260200142815260200182600301544261035591906108dc565b9052336000818152600260208181526040808420898552825292839020855181546001600160a01b0319166001600160a01b039091161781558582015160018201559483015194909101939093558051918252918101859052428183015290517feec977e786e7248a658b0474ccf8f57f37ead019014ec4d5ba1542ddabeff1b4916060908290030190a1505050565b336000908152600260209081526040808320848452909152902080546001600160a01b03166104565760405162461bcd60e51b815260206004820181905260248201527f7468697320737562736372697074696f6e20646f6573206e6f74206578697374604482015260640161022f565b336000818152600260208181526040808420878552825280842080546001600160a01b0319168155600181018590559092019290925580519283529082018490524282820152517fde4047f3bd050ef9b8743c61b37fd72275056d1ccb33d1eb3f22c80cb14df2899181900360600190a15050565b6001600160a01b038083166000908152600260209081526040808320858452825280832060019283905292209081015482549293919290821691166105525760405162461bcd60e51b815260206004820181905260248201527f7468697320737562736372697074696f6e20646f6573206e6f74206578697374604482015260640161022f565b826002015442116105935760405162461bcd60e51b815260206004820152600b60248201526a1b9bdd08191d59481e595d60aa1b604482015260640161022f565b815460028301546040516323b872dd60e01b81526001600160a01b03888116600483015292831660248201526044810191909152908216906323b872dd90606401602060405180830381600087803b1580156105ee57600080fd5b505af1158015610602573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190610626919061089a565b5081546002830154604080516001600160a01b03808a1682529093166020840152820152606081018590524260808201527f577462848cc2ec95e5ef95bf0b154b97340221cd1002ea0511a3877a7f20fb8c9060a00160405180910390a18160030154836002015461069891906108dc565b83600201819055505050505050565b6001600160a01b0383166106fd5760405162461bcd60e51b815260206004820152601e60248201527f616464726573732063616e6e6f74206265206e756c6c20616464726573730000604482015260640161022f565b600082116107445760405162461bcd60e51b81526020600482015260146024820152730616d6f756e74206e6565647320746f2062653e360641b604482015260640161022f565b600081116107945760405162461bcd60e51b815260206004820152601760248201527f6672657175656e6379206e6565647320746f2062653e30000000000000000000604482015260640161022f565b604080516080810182523381526001600160a01b03858116602080840191825283850187815260608501878152600080548152600193849052968720955186549086166001600160a01b031991821617875593519286018054939095169290931691909117909255905160028301555160039091015580549080610817836108f4565b9190505550505050565b80356001600160a01b038116811461083857600080fd5b919050565b6000806040838503121561085057600080fd5b61085983610821565b946020939093013593505050565b60008060006060848603121561087c57600080fd5b61088584610821565b95602085013595506040909401359392505050565b6000602082840312156108ac57600080fd5b815180151581146108bc57600080fd5b9392505050565b6000602082840312156108d557600080fd5b5035919050565b600082198211156108ef576108ef61090f565b500190565b60006000198214156109085761090861090f565b5060010190565b634e487b7160e01b600052601160045260246000fdfea2646970667358221220ff0f920c5b315b3b142df02fd5ec2c485ca1b0b07088584f7f784dc93d459b6e64736f6c63430008070033"


Payment=web3.eth.contract(address=contract_address,abi=abi,bytecode=bytecode)
tx_hash= Payment.constructor().transact()

print(tx_hash)


